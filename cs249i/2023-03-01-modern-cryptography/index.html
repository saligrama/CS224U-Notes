<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="TLS and Modern Cryptography # Some history: 2014 state of encryption # 14% of Alexa Top Million sites supported HTTPS Many: support HTTPS only to redirect you back to HTTP Higher adoption than average sites Most sites used known-weak versions of TLS Only 1 of 4 popular sites supported latest TLS 1.2 4% of sites supported perfect forward secrecy (PFS) Only 1 out of 3 emails encrypted when sent across the internet More history: US export-grade cryptography # Until 1992: US considered cryptography a munition Severely restricted exports of cryptography outside country due to cold-war concerns NSA influence: US exports broken crypto, since NSA no jurisdiction in US &ldquo;people in a random coffee shop shouldn&rsquo;t be able to break foreign crypto, but NSA should&rdquo; Most browsers just used broken crypto everywhere Key length restrictions: Public-key crypto: max 512-bit public keys Symmetric crypto: max 40-bit keys Signatures and MACs unregulated Early 1990s: two versions of Netscape browser: US version w/ full-strength crypto e."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="TLS and Modern Cryptography # Some history: 2014 state of encryption # 14% of Alexa Top Million sites supported HTTPS Many: support HTTPS only to redirect you back to HTTP Higher adoption than average sites Most sites used known-weak versions of TLS Only 1 of 4 popular sites supported latest TLS 1.2 4% of sites supported perfect forward secrecy (PFS) Only 1 out of 3 emails encrypted when sent across the internet More history: US export-grade cryptography # Until 1992: US considered cryptography a munition Severely restricted exports of cryptography outside country due to cold-war concerns NSA influence: US exports broken crypto, since NSA no jurisdiction in US &ldquo;people in a random coffee shop shouldn&rsquo;t be able to break foreign crypto, but NSA should&rdquo; Most browsers just used broken crypto everywhere Key length restrictions: Public-key crypto: max 512-bit public keys Symmetric crypto: max 40-bit keys Signatures and MACs unregulated Early 1990s: two versions of Netscape browser: US version w/ full-strength crypto e."><meta property="og:type" content="article"><meta property="og:url" content="https://saligrama.io/notes/cs249i/2023-03-01-modern-cryptography/"><meta property="article:section" content="cs249i"><title>Modern Cryptography | Aditya's notes</title><link rel=manifest href=/notes/manifest.json><link rel=icon href=/notes/favicon.png type=image/x-icon><link rel=stylesheet href=/notes/book.min.395a67680f48b8d23bbf267f26d0d1259e69554b2b704e371e8e15cbe656e05f.css integrity="sha256-OVpnaA9IuNI7vyZ/JtDRJZ5pVUsrcE43Ho4Vy+ZW4F8=" crossorigin=anonymous><script defer src=/notes/flexsearch.min.js></script>
<script defer src=/notes/en.search.min.20185cea7506331f915ab1ca9873ed3df866348f1939b82a7777023f528a3a47.js integrity="sha256-IBhc6nUGMx+RWrHKmHPtPfhmNI8ZObgqd3cCP1KKOkc=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/notes/><span>Aditya's notes</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-a88f46c31d1ebdf165810583424fda37 class=toggle>
<label for=section-a88f46c31d1ebdf165810583424fda37 class="flex justify-between"><a role=button>CS 103, Fall 2020</a></label><ul><li><a href=/notes/cs103/2020-09-16-set-theory/>Set Theory</a></li><li><a href=/notes/cs103/2020-09-18-indirect-proofs/>Indirect Proofs</a></li><li><a href=/notes/cs103/2020-09-18-mathematical-proofs/>Mathematical Proofs</a></li><li><a href=/notes/cs103/2020-09-26-first-order-logic/>First Order Logic</a></li><li><a href=/notes/cs103/2020-09-26-propositional-logic/>Propositional Logic</a></li><li><a href=/notes/cs103/2020-09-27-first-order-logic-continued/>First Order Logic Continued</a></li><li><a href=/notes/cs103/2020-09-30-binary-relations/>Binary Relations</a></li><li><a href=/notes/cs103/2020-10-01-binary-relations-continued/>Binary Relations Continued</a></li><li><a href=/notes/cs103/2020-10-04-functions/>Functions</a></li><li><a href=/notes/cs103/2020-10-10-cardinality/>Cardinality</a></li><li><a href=/notes/cs103/2020-10-11-graph-theory/>Graph Theory</a></li><li><a href=/notes/cs103/2020-10-17-pigeonhole-principle/>Pigeonhole Principle</a></li><li><a href=/notes/cs103/2020-10-18-induction/>Induction</a></li><li><a href=/notes/cs103/2020-10-19-induction-variants/>Induction Variants</a></li><li><a href=/notes/cs103/2020-10-20-computability-and-formal-languages/>Computability and Formal Languages</a></li><li><a href=/notes/cs103/2020-10-25-nondeterministic-finite-automata/>Nondeterministic Finite Automata</a></li><li><a href=/notes/cs103/2020-10-26-nfa-dfa-equivalence/>Nfa Dfa Equivalence</a></li><li><a href=/notes/cs103/2020-10-26-regular-expressions/>Regular Expressions</a></li><li><a href=/notes/cs103/2020-11-01-nonregular-languages/>Nonregular Languages</a></li><li><a href=/notes/cs103/2020-11-02-context-free-grammars/>Context Free Grammars</a></li><li><a href=/notes/cs103/2020-11-03-turing-machines/>Turing Machines</a></li><li><a href=/notes/cs103/2020-11-08-turing-machine-subroutines/>Turing Machine Subroutines</a></li><li><a href=/notes/cs103/2020-11-08-universal-turing-machine/>Universal Turing Machine</a></li><li><a href=/notes/cs103/2020-11-08-unsolvable-problems/>Unsolvable Problems</a></li><li><a href=/notes/cs103/2020-11-14-unsolvable-problems-continued/>Unsolvable Problems Continued</a></li></ul></li><li><input type=checkbox id=section-cf13475a7a80a5dd57b5a55dce73d171 class=toggle>
<label for=section-cf13475a7a80a5dd57b5a55dce73d171 class="flex justify-between"><a role=button>CS 107, Fall 2020</a></label><ul><li><a href=/notes/cs107/2020-09-18-integer-representations/>Integer Representations</a></li><li><a href=/notes/cs107/2020-09-21-bitwise-operations/>Bitwise Operations</a></li><li><a href=/notes/cs107/2020-09-25-c-chars-and-strings/>C Chars and Strings</a></li><li><a href=/notes/cs107/2020-09-28-more-c-strings/>More C Strings</a></li><li><a href=/notes/cs107/2020-10-02-pointers-arrays/>Pointers Arrays</a></li><li><a href=/notes/cs107/2020-10-05-stack-and-heap/>Stack and Heap</a></li><li><a href=/notes/cs107/2020-10-09-c-generics/>C Generics</a></li><li><a href=/notes/cs107/2020-10-12-function-pointers/>Function Pointers</a></li><li><a href=/notes/cs107/2020-10-16-assembly/>Assembly</a></li><li><a href=/notes/cs107/2020-10-19-assembly-arithmetic-logic/>Assembly Arithmetic Logic</a></li><li><a href=/notes/cs107/2020-10-23-assembly-control-flow/>Assembly Control Flow</a></li><li><a href=/notes/cs107/2020-10-26-assembly-function-calls-and-return-stack/>Assembly Function Calls and Return Stack</a></li><li><a href=/notes/cs107/2020-10-30-heap-management/>Heap Management</a></li><li><a href=/notes/cs107/2020-11-09-program-optimization/>Program Optimization</a></li></ul></li><li><input type=checkbox id=section-4e3bc6e2f7a0feae33c3e43356d49c80 class=toggle>
<label for=section-4e3bc6e2f7a0feae33c3e43356d49c80 class="flex justify-between"><a role=button>CS 110L, Spring 2021</a></label><ul><li><a href=/notes/cs110l/2021-03-30-course-overview/>Course Overview</a></li><li><a href=/notes/cs110l/2021-04-01-fixing-c/>Fixing C</a></li><li><a href=/notes/cs110l/2021-04-06-intro-to-rust/>Intro to Rust</a></li><li><a href=/notes/cs110l/2021-04-08-ownership/>Ownership</a></li><li><a href=/notes/cs110l/2021-04-13-error-handling/>Error Handling</a></li><li><a href=/notes/cs110l/2021-04-22-traits/>Traits</a></li><li><a href=/notes/cs110l/2021-04-27-generics/>Generics</a></li><li><a href=/notes/cs110l/2021-04-29-multiprocessing/>Multiprocessing</a></li></ul></li><li><input type=checkbox id=section-23e7773af736437c02202412a988f2db class=toggle>
<label for=section-23e7773af736437c02202412a988f2db class="flex justify-between"><a role=button>CS 111, Spring 2021</a></label><ul><li><a href=/notes/cs111/2021-03-31-threads-and-dispatching/>Threads and Dispatching</a></li><li><a href=/notes/cs111/2021-04-02-concurrency/>Concurrency</a></li><li><a href=/notes/cs111/2021-04-05-synchronization/>Synchronization</a></li><li><a href=/notes/cs111/2021-04-07-shared-memory-and-condition-variables-and-locks/>Shared Memory and Condition Variables and Locks</a></li><li><a href=/notes/cs111/2021-04-09-lock-implementation-and-deadlocking/>Lock Implementation and Deadlocking</a></li><li><a href=/notes/cs111/2021-04-12-scheduling/>Scheduling</a></li><li><a href=/notes/cs111/2021-04-14-multiprocessing/>Multiprocessing</a></li><li><a href=/notes/cs111/2021-04-16-linking/>Linking</a></li><li><a href=/notes/cs111/2021-04-19-storage-management/>Storage Management</a></li><li><a href=/notes/cs111/2021-04-21-virtual-memory/>Virtual Memory</a></li><li><a href=/notes/cs111/2021-04-23-dynamic-address-translation/>Dynamic Address Translation</a></li><li><a href=/notes/cs111/2021-04-26-segmentation-and-paging/>Segmentation and Paging</a></li><li><a href=/notes/cs111/2021-04-30-demand-paging/>Demand Paging</a></li><li><a href=/notes/cs111/2021-05-05-disks/>Disks</a></li><li><a href=/notes/cs111/2021-05-07-file-systems/>File Systems</a></li><li><a href=/notes/cs111/2021-05-10-realworld-filesystem-structures/>Realworld Filesystem Structures</a></li><li><a href=/notes/cs111/2021-05-12-directories/>Directories</a></li><li><a href=/notes/cs111/2021-05-14-crash-recovery/>Crash Recovery</a></li><li><a href=/notes/cs111/2021-05-19-protection/>Protection</a></li><li><a href=/notes/cs111/2021-05-24-flash-memory/>Flash Memory</a></li><li><a href=/notes/cs111/2021-05-28-virtual-machines/>Virtual Machines</a></li></ul></li><li><input type=checkbox id=section-a586b190ebf0a4874cd21a1d76743261 class=toggle>
<label for=section-a586b190ebf0a4874cd21a1d76743261 class="flex justify-between"><a role=button>CS 143, Spring 2022</a></label><ul><li><a href=/notes/cs143/2022-03-29-intro/>Intro</a></li><li><a href=/notes/cs143/2022-03-31-language-design-and-cool/>Language Design and Cool</a></li><li><a href=/notes/cs143/2022-04-05-lexical-analysis/>Lexical Analysis</a></li><li><a href=/notes/cs143/2022-04-07-lexical-analysis-implementation/>Lexical Analysis Implementation</a></li><li><a href=/notes/cs143/2022-04-12-parsing/>Parsing</a></li><li><a href=/notes/cs143/2022-04-14-syntax-directed-translation/>Syntax Directed Translation</a></li><li><a href=/notes/cs143/2022-04-19-top-down-parsing/>Top Down Parsing</a></li><li><a href=/notes/cs143/2022-04-26-semantic-analysis/>Semantic Analysis</a></li></ul></li><li><input type=checkbox id=section-37836de7a703e433b2642097d511f482 class=toggle>
<label for=section-37836de7a703e433b2642097d511f482 class="flex justify-between"><a role=button>CS 149, Fall 2022</a></label><ul><li><a href=/notes/cs149/2022-09-27-intro/>Intro</a></li><li><a href=/notes/cs149/2022-09-29-modern-multicore-processors/>Modern Multicore Processors</a></li><li><a href=/notes/cs149/2022-10-04-parallel-abstractions/>Parallel Abstractions</a></li><li><a href=/notes/cs149/2022-10-06-parallel-models/>Parallel Models</a></li><li><a href=/notes/cs149/2022-10-11-work-distribution-and-scheduling/>Work Distribution and Scheduling</a></li><li><a href=/notes/cs149/2022-10-13-locality-communication-and-contention/>Locality Communication and Contention</a></li><li><a href=/notes/cs149/2022-10-18-gpu-architecture-and-cuda/>Gpu Architecture and Cuda</a></li><li><a href=/notes/cs149/2022-10-20-data-parallel-architecture/>Data Parallel Architecture</a></li><li><a href=/notes/cs149/2022-10-25-spark/>Spark</a></li><li><a href=/notes/cs149/2022-10-27-cache-coherence/>Cache Coherence</a></li><li><a href=/notes/cs149/2022-11-01-memory-consistency/>Memory Consistency</a></li><li><a href=/notes/cs149/2022-11-03-lock-implementation-and-lock-free-programming/>Lock Implementation and Lock Free Programming</a></li><li><a href=/notes/cs149/2022-11-10-transactional-memory/>Transactional Memory</a></li><li><a href=/notes/cs149/2022-11-29-heterogeneous-processing-and-domain-specific-languages/>Heterogeneous Processing and Domain Specific Languages</a></li><li><a href=/notes/cs149/2022-12-06-asics-and-fpgas/>Asics and Fpgas</a></li></ul></li><li><input type=checkbox id=section-4f9fa520660f975442d4640415905b3c class=toggle>
<label for=section-4f9fa520660f975442d4640415905b3c class="flex justify-between"><a role=button>CS 154, Fall 2021</a></label><ul><li><a href=/notes/cs154/2021-09-28-finite-automata/>Finite Automata</a></li><li><a href=/notes/cs154/2021-10-05-pumping-lemma-and-myhill-nerode/>Pumping Lemma and Myhill Nerode</a></li><li><a href=/notes/cs154/2021-10-12-streaming-algorithms-and-turing-machines/>Streaming Algorithms and Turing Machines</a></li></ul></li><li><input type=checkbox id=section-d24cd7d7d21fe73135d596a09b50887f class=toggle>
<label for=section-d24cd7d7d21fe73135d596a09b50887f class="flex justify-between"><a role=button>CS 155, Spring 2022</a></label><ul><li><a href=/notes/cs155/2022-03-28-intro/>Intro</a></li><li><a href=/notes/cs155/2022-03-30-control-hijacking/>Control Hijacking</a></li><li><a href=/notes/cs155/2022-04-04-control-hijacking-defenses/>Control Hijacking Defenses</a></li><li><a href=/notes/cs155/2022-04-06-security-principles/>Security Principles</a></li><li><a href=/notes/cs155/2022-04-11-isolation-and-sandboxing/>Isolation and Sandboxing</a></li><li><a href=/notes/cs155/2022-04-13-vuln-finding/>Vuln Finding</a></li><li><a href=/notes/cs155/2022-04-18-web-security/>Web Security</a></li><li><a href=/notes/cs155/2022-04-20-web-attacks/>Web Attacks</a></li><li><a href=/notes/cs155/2022-04-25-web-defenses/>Web Defenses</a></li><li><a href=/notes/cs155/2022-05-04-processor-security/>Processor Security</a></li><li><a href=/notes/cs155/2022-05-09-internet-protocol-security/>Internet Protocol Security</a></li></ul></li><li><input type=checkbox id=section-471622039e8d87cd8d642483c8d218b8 class=toggle>
<label for=section-471622039e8d87cd8d642483c8d218b8 class="flex justify-between"><a role=button>CS 161, Winter 2022</a></label><ul><li><a href=/notes/cs161/2022-01-03-intro/>Intro</a></li><li><a href=/notes/cs161/2022-01-05-worst-case-and-asymptotic-analysis/>Worst Case and Asymptotic Analysis</a></li><li><a href=/notes/cs161/2022-01-10-recurrence-relations/>Recurrence Relations</a></li><li><a href=/notes/cs161/2022-01-12-median-and-selection/>Median and Selection</a></li><li><a href=/notes/cs161/2022-01-19-randomized-algorithms-and-quicksort/>Randomized Algorithms and Quicksort</a></li><li><a href=/notes/cs161/2022-01-24-sorting-lower-bounds/>Sorting Lower Bounds</a></li><li><a href=/notes/cs161/2022-01-26-binary-search-trees/>Binary Search Trees</a></li><li><a href=/notes/cs161/2022-01-31-hashing/>Hashing</a></li><li><a href=/notes/cs161/2022-02-02-graphs-and-graph-search/>Graphs and Graph Search</a></li><li><a href=/notes/cs161/2022-02-07-strongly-connected-components/>Strongly Connected Components</a></li><li><a href=/notes/cs161/2022-02-09-weighted-graphs-and-dijkstra/>Weighted Graphs and Dijkstra</a></li><li><a href=/notes/cs161/2022-02-14-dynamic-programming/>Dynamic Programming</a></li><li><a href=/notes/cs161/2022-02-16-dynamic-programming-applications/>Dynamic Programming Applications</a></li><li><a href=/notes/cs161/2022-02-23-greedy-algorithms/>Greedy Algorithms</a></li><li><a href=/notes/cs161/2022-02-28-minimum-spanning-trees/>Minimum Spanning Trees</a></li></ul></li><li><input type=checkbox id=section-0794dc87987599843ba69a8ea82e9b6a class=toggle>
<label for=section-0794dc87987599843ba69a8ea82e9b6a class="flex justify-between"><a role=button>CS 224U, Spring 2021</a></label><ul><li><a href=/notes/cs224u/2021-03-29-course-overview/>Course Overview</a></li><li><a href=/notes/cs224u/2021-03-31-vector-space-models/>Vector Space Models</a></li><li><a href=/notes/cs224u/2021-04-12-sentiment-analysis/>Sentiment Analysis</a></li></ul></li><li><input type=checkbox id=section-efae8264f5fe410feb1b40be6f99baea class=toggle>
<label for=section-efae8264f5fe410feb1b40be6f99baea class="flex justify-between"><a role=button>CS 229, Fall 2021</a></label><ul><li><a href=/notes/cs229/2021-09-21-intro/>Intro</a></li><li><a href=/notes/cs229/2021-09-23-supervised-learning-setup/>Supervised Learning Setup</a></li><li><a href=/notes/cs229/2021-09-28-logistic-regression/>Logistic Regression</a></li><li><a href=/notes/cs229/2021-09-30-generalized-linear-models/>Generalized Linear Models</a></li><li><a href=/notes/cs229/2021-10-05-generative-learning-algorithms/>Generative Learning Algorithms</a></li><li><a href=/notes/cs229/2021-10-07-naive-bayes/>Naive Bayes</a></li><li><a href=/notes/cs229/2021-10-12-kernel-methods-and-svm/>Kernel Methods and Svm</a></li><li><a href=/notes/cs229/2021-10-14-deep-learning/>Deep Learning</a></li><li><a href=/notes/cs229/2021-10-19-deep-learning-optimization/>Deep Learning Optimization</a></li><li><a href=/notes/cs229/2021-10-21-model-selection/>Model Selection</a></li></ul></li><li><input type=checkbox id=section-58493bdbfe80396f07f44c40ecf068c8 class=toggle checked>
<label for=section-58493bdbfe80396f07f44c40ecf068c8 class="flex justify-between"><a role=button>CS 249I, Winter 2023</a></label><ul><li><a href=/notes/cs249i/2023-01-09-internet-players/>Internet Players</a></li><li><a href=/notes/cs249i/2023-01-18-modern-routing-practices/>Modern Routing Practices</a></li><li><a href=/notes/cs249i/2023-01-23-last-mile-access/>Last Mile Access</a></li><li><a href=/notes/cs249i/2023-01-25-host-and-network-addressing/>Host and Network Addressing</a></li><li><a href=/notes/cs249i/2023-01-30-domain-name-system/>Domain Name System</a></li><li><a href=/notes/cs249i/2023-02-06-internet-governance/>Internet Governance</a></li><li><a href=/notes/cs249i/2023-02-08-modern-web-protocols/>Modern Web Protocols</a></li><li><a href=/notes/cs249i/2023-02-13-tls-and-webpki/>Tls and Webpki</a></li><li><a href=/notes/cs249i/2023-02-13-web-content/>Web Content</a></li><li><a href=/notes/cs249i/2023-02-22-internet-crime/>Internet Crime</a></li><li><a href=/notes/cs249i/2023-02-27-middleboxes-and-nat-and-https-interception/>Middleboxes and Nat and Https Interception</a></li><li><a href=/notes/cs249i/2023-03-01-modern-cryptography/ class=active>Modern Cryptography</a></li><li><a href=/notes/cs249i/2023-03-06-content-delivery/>Content Delivery</a></li><li><a href=/notes/cs249i/2023-03-08-internet-censorship/>Internet Censorship</a></li></ul></li><li><input type=checkbox id=section-292ea4e126876f1048e61c4dc744546c class=toggle>
<label for=section-292ea4e126876f1048e61c4dc744546c class="flex justify-between"><a role=button>CS 251, Fall 2022</a></label><ul><li><a href=/notes/cs251/2022-09-26-intro/>Intro</a></li><li><a href=/notes/cs251/2022-09-28-bitcoin-mechanics/>Bitcoin Mechanics</a></li><li><a href=/notes/cs251/2022-10-03-bitcoin-scripts-and-wallets/>Bitcoin Scripts and Wallets</a></li><li><a href=/notes/cs251/2022-10-05-consensus/>Consensus</a></li><li><a href=/notes/cs251/2022-10-10-internet-consensus/>Internet Consensus</a></li><li><a href=/notes/cs251/2022-10-17-ethereum/>Ethereum</a></li><li><a href=/notes/cs251/2022-10-19-solidity/>Solidity</a></li><li><a href=/notes/cs251/2022-11-02-legal-aspects-and-regulation/>Legal Aspects and Regulation</a></li><li><a href=/notes/cs251/2022-11-07-privacy-and-deanonymization-and-mixing/>Privacy and Deanonymization and Mixing</a></li><li><a href=/notes/cs251/2022-11-09-privacy-via-zk-snarks/>Privacy via Zk Snarks</a></li></ul></li><li><input type=checkbox id=section-98d861db134658b3e020a9d74c50ad24 class=toggle>
<label for=section-98d861db134658b3e020a9d74c50ad24 class="flex justify-between"><a role=button>CS 255, Winter 2022</a></label><ul><li><a href=/notes/cs255/2022-01-03-intro/>Intro</a></li><li><a href=/notes/cs255/2022-01-05-stream-ciphers/>Stream Ciphers</a></li><li><a href=/notes/cs255/2022-01-10-block-ciphers/>Block Ciphers</a></li><li><a href=/notes/cs255/2022-01-12-pseudorandom-functions/>Pseudorandom Functions</a></li><li><a href=/notes/cs255/2022-01-19-data-integrity-and-macs/>Data Integrity and Macs</a></li><li><a href=/notes/cs255/2022-01-24-collision-resistance/>Collision Resistance</a></li><li><a href=/notes/cs255/2022-01-26-authenticated-encryption/>Authenticated Encryption</a></li><li><a href=/notes/cs255/2022-01-31-key-management/>Key Management</a></li><li><a href=/notes/cs255/2022-02-02-key-exchange-math/>Key Exchange Math</a></li><li><a href=/notes/cs255/2022-02-07-public-key-encryption/>Public Key Encryption</a></li><li><a href=/notes/cs255/2022-02-09-pke-schemes/>Pke Schemes</a></li><li><a href=/notes/cs255/2022-02-14-digital-signatures/>Digital Signatures</a></li><li><a href=/notes/cs255/2022-02-16-certificates/>Certificates</a></li><li><a href=/notes/cs255/2022-02-23-id-protocols/>Id Protocols</a></li><li><a href=/notes/cs255/2022-02-28-key-exchange-protocols/>Key Exchange Protocols</a></li><li><a href=/notes/cs255/2022-03-02-zero-knowledge-protocols/>Zero Knowledge Protocols</a></li><li><a href=/notes/cs255/2022-03-07-quantum-cryptography/>Quantum Cryptography</a></li></ul></li><li><input type=checkbox id=section-3c4550884ed49f470e55fabac7077d16 class=toggle>
<label for=section-3c4550884ed49f470e55fabac7077d16 class="flex justify-between"><a role=button>Cs153</a></label><ul><li><a href=/notes/cs153/2023-01-12-intro/>Intro</a></li></ul></li><li><input type=checkbox id=section-568ed1bc8289796d56a6d06a22d7eb40 class=toggle>
<label for=section-568ed1bc8289796d56a6d06a22d7eb40 class="flex justify-between"><a role=button>INTLPOL 268, Fall 2021</a></label><ul><li><a href=/notes/intlpol268/2021-09-20-intro/>Intro</a></li><li><a href=/notes/intlpol268/2021-09-22-legal-intro-and-electronic-communications-privacy-act/>Legal Intro and Electronic Communications Privacy Act</a></li><li><a href=/notes/intlpol268/2021-09-27-web-requests-and-attacks/>Web Requests and Attacks</a></li><li><a href=/notes/intlpol268/2021-09-29-ecpa-for-private-actors/>Ecpa for Private Actors</a></li><li><a href=/notes/intlpol268/2021-10-04-cyberattacks/>Cyberattacks</a></li><li><a href=/notes/intlpol268/2021-10-06-computer-fraud-and-abuse-act/>Computer Fraud and Abuse Act</a></li><li><a href=/notes/intlpol268/2021-10-11-network-security/>Network Security</a></li><li><a href=/notes/intlpol268/2021-10-13-cfaa-dmca-and-security-research/>Cfaa Dmca and Security Research</a></li><li><a href=/notes/intlpol268/2021-10-20-data-security-laws/>Data Security Laws</a></li><li><a href=/notes/intlpol268/2021-10-25-corporate-intrusion/>Corporate Intrusion</a></li><li><a href=/notes/intlpol268/2021-10-27-ransomware-and-foreign-hackers/>Ransomware and Foreign Hackers</a></li><li><a href=/notes/intlpol268/2021-11-01-cryptography/>Cryptography</a></li><li><a href=/notes/intlpol268/2021-11-03-cyber-conflict/>Cyber Conflict</a></li><li><a href=/notes/intlpol268/2021-11-08-dark-web-and-cryptocurrencies/>Dark Web and Cryptocurrencies</a></li><li><a href=/notes/intlpol268/2021-11-10-encryption-and-technical-assistance/>Encryption and Technical Assistance</a></li><li><a href=/notes/intlpol268/2021-11-15-malware/>Malware</a></li><li><a href=/notes/intlpol268/2021-11-17-government-hacking/>Government Hacking</a></li><li><a href=/notes/intlpol268/2021-11-29-new-frontiers/>New Frontiers</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/notes/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Modern Cryptography</strong>
<label for=toc-control><img src=/notes/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#tls-and-modern-cryptography>TLS and Modern Cryptography</a><ul><li><a href=#some-history-2014-state-of-encryption>Some history: 2014 state of encryption</a></li><li><a href=#more-history-us-export-grade-cryptography>More history: US export-grade cryptography</a></li><li><a href=#sslv2-broken>SSLv2 (broken)</a><ul><li><a href=#process>Process</a></li><li><a href=#problems>Problems</a></li></ul></li><li><a href=#tls>TLS</a><ul><li><a href=#changes-from-sslv2>Changes from SSLv2</a></li><li><a href=#cipher-suites>Cipher suites</a></li><li><a href=#tls-11-2006>TLS 1.1 (2006)</a></li><li><a href=#tls-12-2008>TLS 1.2 (2008)</a><ul><li><a href=#extension-tls-sni-multiplexing-on-names>Extension: TLS SNI (multiplexing on names)</a></li></ul></li><li><a href=#attacks-2012-2017>Attacks, 2012-2017</a></li><li><a href=#tls-13-2018>TLS 1.3 (2018)</a><ul><li><a href=#more-on-aead-authenticated-encryption-w-associated-data>More on AEAD (authenticated encryption w/ associated data)</a></li></ul></li></ul></li><li><a href=#noise-protocol-framework>Noise protocol framework</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=tls-and-modern-cryptography>TLS and Modern Cryptography
<a class=anchor href=#tls-and-modern-cryptography>#</a></h1><h2 id=some-history-2014-state-of-encryption>Some history: 2014 state of encryption
<a class=anchor href=#some-history-2014-state-of-encryption>#</a></h2><ul><li>14% of Alexa Top Million sites supported HTTPS<ul><li>Many: support HTTPS only to redirect you back to HTTP</li><li>Higher adoption than average sites</li></ul></li><li>Most sites used known-weak versions of TLS<ul><li>Only 1 of 4 popular sites supported latest TLS 1.2</li></ul></li><li>4% of sites supported perfect forward secrecy (PFS)</li><li>Only 1 out of 3 emails encrypted when sent across the internet</li></ul><h2 id=more-history-us-export-grade-cryptography>More history: US export-grade cryptography
<a class=anchor href=#more-history-us-export-grade-cryptography>#</a></h2><ul><li>Until 1992: US considered cryptography a <strong>munition</strong><ul><li>Severely restricted exports of cryptography outside country due to cold-war concerns</li><li>NSA influence: US exports broken crypto, since NSA no jurisdiction in US<ul><li>&ldquo;people in a random coffee shop shouldn&rsquo;t be able to break foreign crypto, but NSA should&rdquo;</li></ul></li><li>Most browsers just used broken crypto everywhere</li></ul></li><li>Key length restrictions:<ul><li>Public-key crypto: max 512-bit public keys</li><li>Symmetric crypto: max 40-bit keys</li><li>Signatures and MACs unregulated</li></ul></li><li>Early 1990s: two versions of Netscape browser:<ul><li>US version w/ full-strength crypto e.g. 1024-bit RSA, 128-bit RC4</li><li>Export version: 40-bit RC2, 512-bit RSA</li></ul></li><li>1996: Bernstein v. United States: Daniel Bernstein sued US government, saying that right to publish software w/ full crypto was 1st amendment right<ul><li>9th circuit 3-judge panel ruled in his favor, so crypto export regulations were ruled unconstitutional</li><li>US gov appeals, full 9th circuit overturns &ndash; no precedent set</li><li>Bernstein sued again, but Clinton admin released executive order delegating export regulation authority to Commerce Department (rather than State)<ul><li>Now: crypto allowed to be exported (and published open-source), as long as Commerce Department is informed</li><li>In practice: regulation is ignored; cryptography effectively unregulated</li></ul></li></ul></li></ul><h2 id=sslv2-broken>SSLv2 (broken)
<a class=anchor href=#sslv2-broken>#</a></h2><h3 id=process>Process
<a class=anchor href=#process>#</a></h3><ol><li>Client hello: random, client supported ciphers provided</li><li>Server hello: random, server supported ciphers provided</li><li>Client master key: cipher, <code>mk_clear</code>, <code>Enc_pk(mk_secret)</code> (client selects cipher)</li><li>Agree on: <code>write_key, read_key = KDF(cipher, mk_clear concat mk_secret)</code></li><li>Server verify: <code>Enc_swk(random_client)</code></li><li>Client finished: <code>Enc_cwk(random_server)</code></li><li>Server finished: <code>Enc_swk(session_id)</code></li></ol><h3 id=problems>Problems
<a class=anchor href=#problems>#</a></h3><ul><li>No commitment to handshake messages<ul><li>MITM can force downgrade without knowing keys, incl. to bad ciphers</li><li>Fixed to non-HMAC MD5 hash function<ul><li>No collision resistance, does have preimage and second-preimage resistance</li><li>MAC is not an HMAC, just a keyed hash &ndash; vulnerable to length extensions</li></ul></li><li>No concept of cert chains, just leaf certs</li><li>Only stream cipher is RC4 (broken)</li><li>Block ciphers all used in CBC mode: padding oracle issues</li></ul></li><li>2016 Drown attack: sites used same pk/sk with both SSLv2 and TLS, breaking TLS security</li><li>However: general principles provided base for TLS</li></ul><h2 id=tls>TLS
<a class=anchor href=#tls>#</a></h2><h3 id=changes-from-sslv2>Changes from SSLv2
<a class=anchor href=#changes-from-sslv2>#</a></h3><ul><li>Client hello: ciphers define more hash types</li><li>Server now chooses the cipher from the client hello</li><li>Certificate process now supports cert chains (intermediate certs)</li><li>Client key exchange based on premaster secret</li><li>Session finished fixes cipher selection MITM</li></ul><h3 id=cipher-suites>Cipher suites
<a class=anchor href=#cipher-suites>#</a></h3><p>Defines key exchange, signature and hash if needed, and symmetric encryption used for a connection, e.g.</p><ul><li><code>TLS_RSA_WITH_AES_128_CBC_SHA</code></li><li><code>TLS_RSA_EXPORT1024_WITH_RC4_56_MD5</code></li><li><code>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</code></li></ul><h3 id=tls-11-2006>TLS 1.1 (2006)
<a class=anchor href=#tls-11-2006>#</a></h3><ul><li>Implicit initialization vector (IV) replaced with explicit IV to replace against CBC attacks</li><li>Handling of padded errors to use <code>bad_record_mac</code> alert rather than <code>decryption_failed</code> alert</li></ul><h3 id=tls-12-2008>TLS 1.2 (2008)
<a class=anchor href=#tls-12-2008>#</a></h3><ul><li>MD5/SHA1 combination in PRF replaced with cipher-suite-specified PRF</li><li>MD5/SHA1 combination in digitally signed element replaced with single hash</li><li>Addition of support for authenticated encryption with additional data modes</li><li>Extensions</li></ul><h4 id=extension-tls-sni-multiplexing-on-names>Extension: TLS SNI (multiplexing on names)
<a class=anchor href=#extension-tls-sni-multiplexing-on-names>#</a></h4><ul><li>If more than one service per host, need to multiplex by some identifier (usually name)</li><li>HTTP virtual hosting powered by the <code>Host</code> header; TLS exposes this via Server Name Indication (SNI) extension</li></ul><h3 id=attacks-2012-2017>Attacks, 2012-2017
<a class=anchor href=#attacks-2012-2017>#</a></h3><ul><li>BEAST (2012), Lucky 13 (2013) - attacks against CBC ciphers<ul><li>Get rid of CBC!</li></ul></li><li>POODLE (2014), Sweet32 (2016), SHA-1 collision (2017)<ul><li>Get rid of SSLv3, 3DES, SHA-1</li></ul></li><li>FREAK (2015), Logjam (2015), DROWN (2015) - attacks against export-grade ciphers</li><li>Diffie-Hellman Key Exchange (see CS255 notes), finite-field version broken in practice (Adrian et al. 2015)<ul><li>Why the attack works:<ul><li>In practice, DHE uses standardized <code>p</code> (field being used), but that the only thing that precomputation of number field sieve (discrete log breaker)</li><li>Precomputation is the only hard part of number field sieve! So in practice, easy (10 core min) to run the descent stage to decrypt practice</li></ul></li><li>Why? Result of a miscommunication between cryptographic and systems community, so these primes are in an RFC</li><li>Logjam attack: MITM substitutes client <code>DHE</code> to <code>EXPORT_DHE</code>, server <code>EXPORT_DHE</code> to <code>DHE</code>, easy to <strong>passively decrypt</strong> the export-grade DHE at 512 bits</li><li>Mitigations<ul><li>Browsers raised minimum prime size to 768 bits, with plans to drop all support for DHE<ul><li>Asymptotically, breaking 768 or 1024 bit keys is hard</li><li>But: very parallelizable: building ASIC for &lt;$100M (small fraction of NSA budget) can precompute for 1024-bit prime in a year</li></ul></li><li>Servers disabled export ciphers, plans to move to ECDHE instead</li><li>In 2015: 82% of Apache vulnerable; in a year this went down to sub-10%, and now FFDHE has become completely deprecated</li></ul></li></ul></li></ul><h3 id=tls-13-2018>TLS 1.3 (2018)
<a class=anchor href=#tls-13-2018>#</a></h3><ul><li>Removed:<ul><li>Problematic features from the past e.g. compression, renegotiation</li><li>Known broken ciphers like MD5, SHA1, RC4, 3DES, CBC mode, FFDHE, export ciphers, user-defined groups</li><li>Non-perfect-forward-secret handshakes, non-AEAD ciphers</li></ul></li><li>Added:<ul><li>Simplified handshake with one fewer round-trip</li><li>Protection against downgrade attacks (e.g. signature over entire exchange)</li><li>Support for newer elliptic curves (e.g. x25519 and 448)</li><li>Zero-round-trip session resumption<ul><li>Messages are replayable (no noce), leading to security flaws &ndash; spec says not to handle requests that modify data until after the replay window is up (after server finishes handshake)</li><li>Primarily used by big tech</li><li>&ldquo;Sketchiest part of TLS 1.3&rdquo;</li></ul></li></ul></li><li>Finalized in 2018 after ~5 years; involved academic community during design<ul><li>Uncovered multiple attacks which were fixed in final version</li><li>Fixed issues with broken middleboxes: TLS 1.3 identifies itself as TLS 1.2 with an extension saying that the actual version is 1.3</li></ul></li><li>As of 2021: traffic into Cloudflare is about 70% TLS 1.3, 17% QUIC, 13% TLS 1.2<ul><li>Web ecosystem looks good because browsers know how to update themselves well, everything else <em>sucks</em> (e.g. IoT embedded stacks, LDAP over TLS, SMTP [no cert validation!], etc.)</li></ul></li><li>Now: TLS 1.3 is pretty good! Generic communication stack should be gRPC over TLS 1.3, unless there&rsquo;s a good reason for otherwise (e.g. resource constraints &ndash; see Noise)</li></ul><h4 id=more-on-aead-authenticated-encryption-w-associated-data>More on AEAD (authenticated encryption w/ associated data)
<a class=anchor href=#more-on-aead-authenticated-encryption-w-associated-data>#</a></h4><ul><li>Why AEADs are good:<ul><li>Use plaintext packet header as associated data (which can contain length, message type, etc)</li><li>AEAD functions like a stream cipher, with no padding needed &ndash; output length matches input length + tag (MAC) length</li><li>Nonces can be sent in plaintext; randomly generated without reuse</li></ul></li><li>Issue: nonce management dependent on specific AEAD, not all need them. If nonce reused, catastrophic issues</li></ul><h2 id=noise-protocol-framework>Noise protocol framework
<a class=anchor href=#noise-protocol-framework>#</a></h2><ul><li>Noise: set of guidelines for authetnicated secure channels using Diffie-Hellman as only asymmetric primitive combined with an AEAD<ul><li>No signatures</li><li>Parties: initiators, responders</li></ul></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#tls-and-modern-cryptography>TLS and Modern Cryptography</a><ul><li><a href=#some-history-2014-state-of-encryption>Some history: 2014 state of encryption</a></li><li><a href=#more-history-us-export-grade-cryptography>More history: US export-grade cryptography</a></li><li><a href=#sslv2-broken>SSLv2 (broken)</a><ul><li><a href=#process>Process</a></li><li><a href=#problems>Problems</a></li></ul></li><li><a href=#tls>TLS</a><ul><li><a href=#changes-from-sslv2>Changes from SSLv2</a></li><li><a href=#cipher-suites>Cipher suites</a></li><li><a href=#tls-11-2006>TLS 1.1 (2006)</a></li><li><a href=#tls-12-2008>TLS 1.2 (2008)</a><ul><li><a href=#extension-tls-sni-multiplexing-on-names>Extension: TLS SNI (multiplexing on names)</a></li></ul></li><li><a href=#attacks-2012-2017>Attacks, 2012-2017</a></li><li><a href=#tls-13-2018>TLS 1.3 (2018)</a><ul><li><a href=#more-on-aead-authenticated-encryption-w-associated-data>More on AEAD (authenticated encryption w/ associated data)</a></li></ul></li></ul></li><li><a href=#noise-protocol-framework>Noise protocol framework</a></li></ul></li></ul></nav></div></aside></main></body></html>